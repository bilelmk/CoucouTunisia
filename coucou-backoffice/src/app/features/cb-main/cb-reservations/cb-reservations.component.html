<div class="page">

  <div class="row mt-2 mb-2 justify-content-between align-items-center">
    <p class="title">
      <span class="material-icons title-icon">edit_calendar</span>
      Listes des réservations
    </p>
    <div class="row align-items-center">
      <button class="square-btn ml-2"  (click)="openModal(false , null)">
        <i class="material-icons icon-blue" >
          add
        </i>
      </button>
    </div>
  </div>

  <div class="row"  *ngIf="reservations?.length > 0">
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">

      <ng-container matColumnDef="restaurant" >
        <mat-header-cell *matHeaderCellDef >Restaurant</mat-header-cell>
        <mat-cell *matCellDef="let reservation" >
          <p class="cell-text"  > {{reservation.restaurant.name}} </p>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="client" >
        <mat-header-cell *matHeaderCellDef >Client</mat-header-cell>
        <mat-cell *matCellDef="let reservation" >
          <p class="cell-text"  > {{reservation.client.firstName +  " " + reservation.client.lastName }} </p>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="date">
        <mat-header-cell *matHeaderCellDef >Date</mat-header-cell>
        <mat-cell *matCellDef="let reservation" >
          <p class="cell-text" > {{reservation.date | date}} </p>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="time">
        <mat-header-cell *matHeaderCellDef >Heure</mat-header-cell>
        <mat-cell *matCellDef="let reservation" >
          <p class="cell-text" > {{reservation.time}} </p>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="adultNumber">
        <mat-header-cell *matHeaderCellDef >Nombre d'adults</mat-header-cell>
        <mat-cell *matCellDef="let reservation" >
          <p class="cell-text" > {{reservation.adultNumber}} </p>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="childrenNumber">
        <mat-header-cell *matHeaderCellDef >Nombre d'enfants</mat-header-cell>
        <mat-cell *matCellDef="let reservation" >
          <p class="cell-text" > {{reservation.childrenNumber}} </p>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="babeNumber">
        <mat-header-cell *matHeaderCellDef >Nombre de Bébé</mat-header-cell>
        <mat-cell *matCellDef="let reservation" >
          <p class="cell-text" > {{reservation.babeNumber}} </p>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="carNumber">
        <mat-header-cell *matHeaderCellDef >Nombre de voitures</mat-header-cell>
        <mat-cell *matCellDef="let reservation" >
          <p class="cell-text" > {{reservation.carNumber}} </p>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="state">
        <mat-header-cell *matHeaderCellDef >Etat</mat-header-cell>
        <mat-cell *matCellDef="let reservation" >
          <p class="cell-text" > {{reservation.state}} </p>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="canceled">
        <mat-header-cell *matHeaderCellDef >Annulé</mat-header-cell>
        <mat-cell class="cell-text" *matCellDef="let reservation">
          <div class="cell-text">
            <mat-icon *ngIf="reservation?.canceled" class="icon-danger">remove_circle</mat-icon>
            <mat-icon  *ngIf="!reservation?.canceled" class="icon-success">check_circle</mat-icon>
          </div>
        </mat-cell>
      </ng-container>


      <ng-container matColumnDef="buttons">
        <mat-header-cell *matHeaderCellDef>Actions</mat-header-cell>
        <mat-cell class="cell-text" *matCellDef="let reservation">
          <div class="cell-btn" (click)="confirm(reservation)">
            <mat-icon>flaky</mat-icon>
          </div>
          <div class="cell-btn" (click)="openModal(true , reservation)" >
            <mat-icon>edit</mat-icon>
          </div>
        </mat-cell>
      </ng-container>

      <mat-header-row class="text-center" *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row class="contact" *matRowDef="let type; columns: displayedColumns;" ></mat-row>

    </table>
    <mat-paginator class="full-width"
                   [length]="this.recordsNumber"
                   [pageSize]="limit"
                   (page)="pageEvent = $event ; onPaginationChange($event)"
    ></mat-paginator>
  </div>

  <div class="row justify-content-center align-items-center" style=" height: 70vh !important;"
       *ngIf="reservations?.length == 0 && error" >
    <div class="col-12 row justify-content-center align-items-center" *ngIf="reservations?.length == 0 && !error"  >
      <img  src="assets/img/no-record.png" >
      <div class="col-12 text-center" >
        <p >No record found</p>
      </div>
    </div>
    <div class="col-12 row justify-content-center align-items-center" *ngIf="error"  >
      <img  src="assets/img/error.png" >
      <div class="col-12 text-center" >
        <p>Server error</p>
      </div>
    </div>
  </div>
</div>
