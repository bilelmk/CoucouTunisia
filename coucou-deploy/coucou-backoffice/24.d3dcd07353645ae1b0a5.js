(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{zPa8:function(t,e,i){"use strict";i.r(e),i.d(e,"CbRolesModule",(function(){return dt}));var s=i("ofXK"),a=i("+0xr"),n=i("M9IT"),r=i("0IaG"),c=i("3Pt+"),o=i("GCMQ"),l=i("fXoL"),b=i("TDQM"),d=i("6va7"),u=i("tk/3"),m=i("kmnG"),f=i("qFsG");function p(t,e){1&t&&(l.Tb(0,"p",10),l.Ic(1,"Ajouter un role"),l.Sb())}function h(t,e){1&t&&(l.Tb(0,"p",10),l.Ic(1,"Modifi\xe9 role"),l.Sb())}function S(t,e){if(1&t&&(l.Tb(0,"mat-error"),l.Ic(1),l.Sb()),2&t){const t=l.fc();l.Bb(1),l.Kc(" ",null==t.errors?null:t.errors.required," ")}}function v(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",11),l.bc("click",(function(){return l.xc(t),l.fc().add()})),l.Ic(1," Ajouter "),l.Sb()}if(2&t){const t=l.fc();l.nc("disabled",!t.form.valid)}}function g(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",11),l.bc("click",(function(){return l.xc(t),l.fc().update()})),l.Ic(1," Sauvgarder "),l.Sb()}if(2&t){const t=l.fc();l.nc("disabled",!t.form.valid)}}let T=(()=>{class t{constructor(t,e,i,s,a,n){this.dialog=t,this.matDialogRef=e,this.data=i,this.snackbarService=s,this.roleService=a,this.http=n,this.permissions=[]}ngOnInit(){this.http.get("assets/other/errors.json").subscribe(t=>{this.errors=t}),this.form=new c.g(this.data.isEditMode?{name:new c.e(this.data.item.name,c.u.required),description:new c.e(this.data.item.description||"")}:{description:new c.e(""),name:new c.e("",c.u.required)})}add(){this.roleService.add(this.form.value).subscribe(t=>{o.a.addToArray(t,this.data.array),this.snackbarService.openSnackBar("Role ajout\xe9e avec succ\xe8s","success"),this.matDialogRef.close()},t=>{this.snackbarService.openSnackBar("Erreur lors de l'ajout de role","fail")})}update(){this.roleService.update(this.form.value,this.data.item.id).subscribe(t=>{o.a.updateFields(this.form.value,this.data.item),this.snackbarService.openSnackBar("Role modifier avec succ\xe8s","success"),this.matDialogRef.close()},t=>{this.snackbarService.openSnackBar("Erreur lors de la modification de role","fail")})}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(r.b),l.Nb(r.d),l.Nb(r.a),l.Nb(b.a),l.Nb(d.a),l.Nb(u.b))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-cb-roles-modal"]],decls:18,vars:6,consts:[[1,"dialog-container"],["class","dialog-title",4,"ngIf"],[1,"row","justify-content-center","align-items-center","p-4","pt-3",3,"formGroup"],[1,"col-12"],["appearance","outline",1,"full-width"],["formControlName","name","matInput","","type","text"],[4,"ngIf"],[1,"col-12","mt-1"],["formControlName","description","matInput","","type","text"],["class","submit-btn full-width",3,"disabled","click",4,"ngIf"],[1,"dialog-title"],[1,"submit-btn","full-width",3,"disabled","click"]],template:function(t,e){1&t&&(l.Tb(0,"div",0),l.Gc(1,p,2,0,"p",1),l.Gc(2,h,2,0,"p",1),l.Tb(3,"form",2),l.Tb(4,"div",3),l.Tb(5,"mat-form-field",4),l.Tb(6,"mat-label"),l.Ic(7,"Nom"),l.Sb(),l.Ob(8,"input",5),l.Gc(9,S,2,1,"mat-error",6),l.Sb(),l.Sb(),l.Tb(10,"div",7),l.Tb(11,"mat-form-field",4),l.Tb(12,"mat-label"),l.Ic(13,"Description"),l.Sb(),l.Ob(14,"input",8),l.Sb(),l.Sb(),l.Tb(15,"div",3),l.Gc(16,v,2,1,"button",9),l.Gc(17,g,2,1,"button",9),l.Sb(),l.Sb(),l.Sb()),2&t&&(l.Bb(1),l.nc("ngIf",!e.data.isEditMode),l.Bb(1),l.nc("ngIf",e.data.isEditMode),l.Bb(1),l.nc("formGroup",e.form),l.Bb(6),l.nc("ngIf",!e.form.hasError("required")),l.Bb(7),l.nc("ngIf",!e.data.isEditMode),l.Bb(1),l.nc("ngIf",e.data.isEditMode))},directives:[s.k,c.v,c.o,c.h,m.c,m.f,c.c,f.b,c.n,c.f,m.b],styles:[""]}),t})();var w=i("ZXmM"),I=i("NFeN"),y=i("MutI");const R=["permissionsRef"],k=["rolePermissionsRef"];function G(t,e){if(1&t&&(l.Tb(0,"mat-list-option",15),l.Ic(1),l.Sb()),2&t){const t=e.$implicit;l.nc("value",t),l.Bb(1),l.Kc(" ",t.name," ")}}function B(t,e){if(1&t&&(l.Tb(0,"mat-list-option",15),l.Ic(1),l.Sb()),2&t){const t=e.$implicit;l.nc("value",t),l.Bb(1),l.Kc(" ",t.name," ")}}let N=(()=>{class t{constructor(t,e,i,s,a,n){this.dialog=t,this.matDialogRef=e,this.data=i,this.snackbarService=s,this.roleService=a,this.permissionService=n,this.permissions=[],this.rolePermissions=[]}ngOnInit(){this.permissionService.getAll().subscribe(t=>{if(this.permissions=t,this.data.item.permissions)for(let e of this.data.item.permissions)o.a.addToArray(e,this.rolePermissions),o.a.deleteFromArray(e,this.permissions)},t=>{console.log(t)})}push(){for(let t of this.permissionsRef.selectedOptions.selected)o.a.addToArray(t.value,this.rolePermissions),o.a.deleteFromArray(t.value,this.permissions)}pull(){for(let t of this.rolePermissionsRef.selectedOptions.selected)o.a.addToArray(t.value,this.permissions),o.a.deleteFromArray(t.value,this.rolePermissions)}save(){let t=this.rolePermissions.map(t=>t.id);this.roleService.updatePermissions(this.data.item.id,t).subscribe(t=>{this.data.item.permissions=this.rolePermissions,this.matDialogRef.close()},t=>{console.log(t)})}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(r.b),l.Nb(r.d),l.Nb(r.a),l.Nb(b.a),l.Nb(d.a),l.Nb(w.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-cb-roles-permissions"]],viewQuery:function(t,e){var i;1&t&&(l.Lc(R,!0),l.Lc(k,!0)),2&t&&(l.sc(i=l.cc())&&(e.permissionsRef=i.first),l.sc(i=l.cc())&&(e.rolePermissionsRef=i.first))},decls:24,vars:2,consts:[[1,"dialog-container"],[1,"dialog-title"],[1,"row","pl-3","pr-3","pb-3","justify-content-center"],[1,"col-5","mr-3","no-padding","select-list-container"],[1,"row","justify-content-end"],[1,"mb-2","select-btn",3,"click"],[1,"select-list","no-padding","mt-1"],["permissionsRef",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-5","ml-3","no-padding","select-list-container"],[1,"row","justify-content-start"],["rolePermissionsRef",""],[1,"row"],[1,"col-12"],[1,"full-width","submit-btn",3,"click"],[3,"value"]],template:function(t,e){1&t&&(l.Tb(0,"div",0),l.Tb(1,"p",1),l.Ic(2,"Liste des permissions"),l.Sb(),l.Tb(3,"div",2),l.Tb(4,"div",3),l.Tb(5,"div",4),l.Tb(6,"button",5),l.bc("click",(function(){return e.push()})),l.Tb(7,"mat-icon"),l.Ic(8,"keyboard_double_arrow_right"),l.Sb(),l.Sb(),l.Sb(),l.Tb(9,"mat-selection-list",6,7),l.Gc(11,G,2,2,"mat-list-option",8),l.Sb(),l.Sb(),l.Tb(12,"div",9),l.Tb(13,"div",10),l.Tb(14,"button",5),l.bc("click",(function(){return e.pull()})),l.Tb(15,"mat-icon"),l.Ic(16,"keyboard_double_arrow_left"),l.Sb(),l.Sb(),l.Sb(),l.Tb(17,"mat-selection-list",6,11),l.Gc(19,B,2,2,"mat-list-option",8),l.Sb(),l.Sb(),l.Sb(),l.Tb(20,"div",12),l.Tb(21,"div",13),l.Tb(22,"button",14),l.bc("click",(function(){return e.save()})),l.Ic(23," Sauvgarder "),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&t&&(l.Bb(11),l.nc("ngForOf",e.permissions),l.Bb(8),l.nc("ngForOf",e.rolePermissions))},directives:[I.a,y.e,s.j,y.d],styles:[".select-list[_ngcontent-%COMP%]{border:.5px solid #b3b3b3;height:calc(100% - 40px);overflow-y:scroll}.select-list-container[_ngcontent-%COMP%]{height:320px}"]}),t})();var C=i("uC/U");const O=["restaurantsRef"],x=["roleRestaurantsRef"];function F(t,e){if(1&t&&(l.Tb(0,"mat-list-option",15),l.Ic(1),l.Sb()),2&t){const t=e.$implicit;l.nc("value",t),l.Bb(1),l.Kc(" ",t.name," ")}}function M(t,e){if(1&t&&(l.Tb(0,"mat-list-option",15),l.Ic(1),l.Sb()),2&t){const t=e.$implicit;l.nc("value",t),l.Bb(1),l.Kc(" ",t.name," ")}}let D=(()=>{class t{constructor(t,e,i,s,a,n){this.dialog=t,this.matDialogRef=e,this.data=i,this.snackbarService=s,this.roleService=a,this.restaurantService=n,this.restaurants=[],this.roleRestaurants=[]}ngOnInit(){this.restaurantService.getAllLite().subscribe(t=>{if(this.restaurants=t,this.data.item.restaurants)for(let e of this.data.item.restaurants)o.a.addToArray(e,this.roleRestaurants),o.a.deleteFromArray(e,this.restaurants)},t=>{console.log(t)})}push(){for(let t of this.restaurantsRef.selectedOptions.selected)o.a.addToArray(t.value,this.roleRestaurants),o.a.deleteFromArray(t.value,this.restaurants)}pull(){for(let t of this.roleRestaurantsRef.selectedOptions.selected)o.a.addToArray(t.value,this.restaurants),o.a.deleteFromArray(t.value,this.roleRestaurants)}save(){let t=this.roleRestaurants.map(t=>t.id);this.roleService.updateRestaurants(this.data.item.id,t).subscribe(t=>{this.data.item.restaurants=this.roleRestaurants,this.matDialogRef.close()},t=>{console.log(t)})}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(r.b),l.Nb(r.d),l.Nb(r.a),l.Nb(b.a),l.Nb(d.a),l.Nb(C.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-cb-roles-restaurants"]],viewQuery:function(t,e){var i;1&t&&(l.Lc(O,!0),l.Lc(x,!0)),2&t&&(l.sc(i=l.cc())&&(e.restaurantsRef=i.first),l.sc(i=l.cc())&&(e.roleRestaurantsRef=i.first))},decls:24,vars:2,consts:[[1,"dialog-container"],[1,"dialog-title"],[1,"row","pl-3","pr-3","pb-3","justify-content-center"],[1,"col-5","mr-3","no-padding","select-list-container"],[1,"row","justify-content-end"],[1,"mb-2","select-btn",3,"click"],[1,"select-list","no-padding","mt-1"],["restaurantsRef",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-5","ml-3","no-padding","select-list-container"],[1,"row","justify-content-start"],["roleRestaurantsRef",""],[1,"row"],[1,"col-12"],[1,"full-width","submit-btn",3,"click"],[3,"value"]],template:function(t,e){1&t&&(l.Tb(0,"div",0),l.Tb(1,"p",1),l.Ic(2,"Liste des restaurants"),l.Sb(),l.Tb(3,"div",2),l.Tb(4,"div",3),l.Tb(5,"div",4),l.Tb(6,"button",5),l.bc("click",(function(){return e.push()})),l.Tb(7,"mat-icon"),l.Ic(8,"keyboard_double_arrow_right"),l.Sb(),l.Sb(),l.Sb(),l.Tb(9,"mat-selection-list",6,7),l.Gc(11,F,2,2,"mat-list-option",8),l.Sb(),l.Sb(),l.Tb(12,"div",9),l.Tb(13,"div",10),l.Tb(14,"button",5),l.bc("click",(function(){return e.pull()})),l.Tb(15,"mat-icon"),l.Ic(16,"keyboard_double_arrow_left"),l.Sb(),l.Sb(),l.Sb(),l.Tb(17,"mat-selection-list",6,11),l.Gc(19,M,2,2,"mat-list-option",8),l.Sb(),l.Sb(),l.Sb(),l.Tb(20,"div",12),l.Tb(21,"div",13),l.Tb(22,"button",14),l.bc("click",(function(){return e.save()})),l.Ic(23," Sauvgarder "),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&t&&(l.Bb(11),l.nc("ngForOf",e.restaurants),l.Bb(8),l.nc("ngForOf",e.roleRestaurants))},directives:[I.a,y.e,s.j,y.d],styles:[".select-list[_ngcontent-%COMP%]{border:.5px solid #b3b3b3;height:calc(100% - 40px);overflow-y:scroll}.select-list-container[_ngcontent-%COMP%]{height:320px}"]}),t})();var P=i("zWtS"),j=i("oj2T"),A=i("5chL");function _(t,e){1&t&&(l.Tb(0,"mat-header-cell"),l.Ic(1,"Nom"),l.Sb())}function L(t,e){if(1&t&&(l.Tb(0,"mat-cell"),l.Tb(1,"p",22),l.Ic(2),l.Sb(),l.Sb()),2&t){const t=e.$implicit;l.Bb(2),l.Kc(" ",t.name," ")}}function K(t,e){1&t&&(l.Tb(0,"mat-header-cell"),l.Ic(1,"Description"),l.Sb())}function $(t,e){if(1&t&&(l.Tb(0,"mat-cell"),l.Tb(1,"p",22),l.Ic(2),l.Sb(),l.Sb()),2&t){const t=e.$implicit;l.Bb(2),l.Kc(" ",t.description," ")}}function E(t,e){1&t&&(l.Tb(0,"mat-header-cell"),l.Ic(1,"Permissions"),l.Sb())}function Q(t,e){if(1&t&&(l.Tb(0,"span",24),l.Ic(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Kc(" ",t.name," ")}}function H(t,e){if(1&t&&(l.Tb(0,"mat-cell"),l.Tb(1,"p",22),l.Gc(2,Q,2,1,"span",23),l.Sb(),l.Sb()),2&t){const t=e.$implicit;l.Bb(2),l.nc("ngForOf",null==t?null:t.permissions)}}function q(t,e){1&t&&(l.Tb(0,"mat-header-cell"),l.Ic(1,"Restaurants"),l.Sb())}function z(t,e){if(1&t&&(l.Tb(0,"span",24),l.Ic(1),l.Sb()),2&t){const t=e.$implicit;l.Bb(1),l.Kc(" ",t.name," ")}}function U(t,e){if(1&t&&(l.Tb(0,"mat-cell"),l.Tb(1,"p",22),l.Gc(2,z,2,1,"span",23),l.Sb(),l.Sb()),2&t){const t=e.$implicit;l.Bb(2),l.nc("ngForOf",null==t?null:t.restaurants)}}function X(t,e){1&t&&(l.Tb(0,"mat-header-cell"),l.Ic(1,"Actions"),l.Sb())}function J(t,e){if(1&t){const t=l.Ub();l.Tb(0,"mat-cell",22),l.Tb(1,"div",25),l.bc("click",(function(){l.xc(t);const i=e.$implicit;return l.fc(3).delete(i)})),l.Tb(2,"mat-icon"),l.Ic(3,"delete_forever"),l.Sb(),l.Sb(),l.Tb(4,"div",25),l.bc("click",(function(){l.xc(t);const i=e.$implicit;return l.fc(3).openModal(!0,i)})),l.Tb(5,"mat-icon"),l.Ic(6,"mode_edit"),l.Sb(),l.Sb(),l.Tb(7,"div",25),l.bc("click",(function(){l.xc(t);const i=e.$implicit;return l.fc(3).openPermissionModal(i)})),l.Tb(8,"mat-icon"),l.Ic(9,"lock"),l.Sb(),l.Sb(),l.Tb(10,"div",25),l.bc("click",(function(){l.xc(t);const i=e.$implicit;return l.fc(3).openRestaurantsModal(i)})),l.Tb(11,"mat-icon"),l.Ic(12,"restaurant"),l.Sb(),l.Sb(),l.Sb()}}function V(t,e){1&t&&l.Ob(0,"mat-header-row",26)}function W(t,e){1&t&&l.Ob(0,"mat-row",27)}const Z=function(){return[10]};function Y(t,e){if(1&t&&(l.Tb(0,"div",9),l.Tb(1,"table",10),l.Rb(2,11),l.Gc(3,_,2,0,"mat-header-cell",12),l.Gc(4,L,3,1,"mat-cell",13),l.Qb(),l.Rb(5,14),l.Gc(6,K,2,0,"mat-header-cell",12),l.Gc(7,$,3,1,"mat-cell",13),l.Qb(),l.Rb(8,15),l.Gc(9,E,2,0,"mat-header-cell",12),l.Gc(10,H,3,1,"mat-cell",13),l.Qb(),l.Rb(11,16),l.Gc(12,q,2,0,"mat-header-cell",12),l.Gc(13,U,3,1,"mat-cell",13),l.Qb(),l.Rb(14,17),l.Gc(15,X,2,0,"mat-header-cell",12),l.Gc(16,J,13,0,"mat-cell",18),l.Qb(),l.Gc(17,V,1,0,"mat-header-row",19),l.Gc(18,W,1,0,"mat-row",20),l.Sb(),l.Ob(19,"mat-paginator",21),l.Sb()),2&t){const t=l.fc(2);l.Bb(1),l.nc("dataSource",t.dataSource),l.Bb(16),l.nc("matHeaderRowDef",t.displayedColumns),l.Bb(1),l.nc("matRowDefColumns",t.displayedColumns),l.Bb(1),l.nc("pageSizeOptions",l.pc(4,Z))}}function tt(t,e){if(1&t){const t=l.Ub();l.Tb(0,"div",1),l.Tb(1,"div",2),l.Tb(2,"div"),l.Tb(3,"p",3),l.Tb(4,"span",4),l.Ic(5,"admin_panel_settings"),l.Sb(),l.Ic(6," Liste des roles "),l.Sb(),l.Sb(),l.Tb(7,"div"),l.Tb(8,"button",5),l.bc("click",(function(){return l.xc(t),l.fc().openModal(!1,null)})),l.Tb(9,"i",6),l.Ic(10," add "),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Gc(11,Y,20,5,"div",7),l.Ob(12,"app-cb-errors",8),l.Sb()}if(2&t){const t=l.fc();l.Bb(11),l.nc("ngIf",(null==t.roles?null:t.roles.length)>0),l.Bb(1),l.nc("array",t.roles)("error",t.error)}}let et=(()=>{class t{constructor(t,e,i,s,n){this.spinnerService=t,this.dialog=e,this.alertService=i,this.snackbarService=s,this.roleService=n,this.dataSource=new a.k,this.displayedColumns=["name","description","permissions","restaurants","buttons"],this.roles=[],this.error=!1,this.loading=!1}set paginator(t){t&&(this.dataSource.paginator=t)}ngOnInit(){this.loading=!0,this.spinnerService.activate(),this.roleService.getAll().subscribe(t=>{this.loading=!1,this.roles=t,this.dataSource.data=t,this.spinnerService.deactivate()},t=>{this.loading=!1,this.error=!0,this.spinnerService.deactivate()})}openModal(t,e){this.dialog.open(T,{panelClass:"custom-dialog-container",width:"600px",data:{item:e,array:this.roles,isEditMode:t}}).afterClosed().subscribe(t=>{this.dataSource.data=this.roles})}openPermissionModal(t){this.dialog.open(N,{panelClass:"custom-dialog-container",width:"600px",height:"450px",data:{item:t}}).afterClosed().subscribe(t=>{this.dataSource.data=this.roles})}openRestaurantsModal(t){this.dialog.open(D,{panelClass:"custom-dialog-container",width:"600px",height:"450px",data:{item:t}}).afterClosed().subscribe(t=>{this.dataSource.data=this.roles})}delete(t){this.alertService.showAlert(()=>{this.roleService.delete(t.id).subscribe(e=>{this.snackbarService.openSnackBar("Role supprim\xe9 avec succ\xe8s","success"),o.a.deleteFromArray(t,this.roles),this.dataSource.data=this.roles},t=>{this.snackbarService.openSnackBar("Erreur lors de la suppression","fail"),console.log(t)})},"voulez-vous vraiment supprimer ?")}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(P.a),l.Nb(r.b),l.Nb(j.a),l.Nb(b.a),l.Nb(d.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-cb-roles"]],viewQuery:function(t,e){var i;1&t&&l.Lc(n.a,!0),2&t&&l.sc(i=l.cc())&&(e.paginator=i.first)},decls:1,vars:1,consts:[["class","page",4,"ngIf"],[1,"page"],[1,"row","mt-3","mb-3","justify-content-between","align-items-center"],[1,"title"],[1,"material-icons","title-icon"],[1,"square-btn","ml-2",3,"click"],[1,"material-icons","icon-blue"],["class","row",4,"ngIf"],[3,"array","error"],[1,"row"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","name"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","description"],["matColumnDef","permissions"],["matColumnDef","restaurants"],["matColumnDef","buttons"],["class","cell-text",4,"matCellDef"],["class","text-center",4,"matHeaderRowDef"],["class","contact",4,"matRowDef","matRowDefColumns"],[1,"full-width",3,"pageSizeOptions"],[1,"cell-text"],["class","cell-chips",4,"ngFor","ngForOf"],[1,"cell-chips"],[1,"cell-btn",3,"click"],[1,"text-center"],[1,"contact"]],template:function(t,e){1&t&&l.Gc(0,tt,13,3,"div",0),2&t&&l.nc("ngIf",!e.loading)},directives:[s.k,A.a,a.j,a.c,a.e,a.b,a.g,a.i,n.a,a.d,a.a,s.j,I.a,a.f,a.h],styles:[""]}),t})();var it=i("tyNb"),st=i("PCNd"),at=i("bTqV"),nt=i("FtGj"),rt=i("FKr1");i("8LU1"),i("R1ws"),i("XNiG"),i("VRyK"),i("IzEk"),i("1G5W"),i("JX91"),i("u47x"),i("0EQZ"),i("nLfN"),i("cH1L");const ct=new l.s("mat-chips-default-options"),ot={separatorKeyCodes:[nt.f]};let lt=(()=>{class t{}return t.\u0275mod=l.Lb({type:t}),t.\u0275inj=l.Kb({factory:function(e){return new(e||t)},providers:[rt.b,{provide:ct,useValue:ot}]}),t})();const bt=[{path:"",component:et}];let dt=(()=>{class t{}return t.\u0275mod=l.Lb({type:t}),t.\u0275inj=l.Kb({factory:function(e){return new(e||t)},imports:[[s.c,it.e.forChild(bt),a.l,n.b,st.a,I.b,r.c,y.c,at.b,c.s,m.e,f.c,lt]]}),t})()}}]);