(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{shre:function(e,t,i){"use strict";i.r(t),i.d(t,"CbPermissionsModule",(function(){return H}));var s=i("ofXK"),c=i("+0xr"),n=i("3Pt+"),a=i("0IaG"),r=i("GCMQ"),o=i("fXoL"),l=i("TDQM"),b=i("ZXmM"),d=i("tk/3"),m=i("kmnG"),u=i("qFsG");function p(e,t){1&e&&(o.Tb(0,"p",10),o.Ic(1,"Ajouter une permission"),o.Sb())}function f(e,t){1&e&&(o.Tb(0,"p",10),o.Ic(1,"Modifi\xe9 permission"),o.Sb())}function h(e,t){if(1&e&&(o.Tb(0,"mat-error"),o.Ic(1),o.Sb()),2&e){const e=o.fc();o.Bb(1),o.Kc(" ",null==e.errors?null:e.errors.required," ")}}function S(e,t){if(1&e){const e=o.Ub();o.Tb(0,"button",11),o.bc("click",(function(){return o.xc(e),o.fc().add()})),o.Ic(1," Ajouter "),o.Sb()}if(2&e){const e=o.fc();o.nc("disabled",!e.form.valid)}}function v(e,t){if(1&e){const e=o.Ub();o.Tb(0,"button",11),o.bc("click",(function(){return o.xc(e),o.fc().update()})),o.Ic(1," Sauvgarder "),o.Sb()}if(2&e){const e=o.fc();o.nc("disabled",!e.form.valid)}}let g=(()=>{class e{constructor(e,t,i,s,c,n){this.dialog=e,this.matDialogRef=t,this.data=i,this.snackbarService=s,this.permissionService=c,this.http=n}ngOnInit(){this.http.get("assets/other/errors.json").subscribe(e=>{this.errors=e}),this.form=new n.g(this.data.isEditMode?{name:new n.e(this.data.item.name,n.u.required),description:new n.e(this.data.item.description||"")}:{name:new n.e("",n.u.required),description:new n.e("")})}add(){this.permissionService.add(this.form.value).subscribe(e=>{r.a.addToArray(e,this.data.array),this.snackbarService.openSnackBar("Permission ajout\xe9e avec succ\xe8s","success"),this.matDialogRef.close()},e=>{this.snackbarService.openSnackBar("Erreur lors de l'ajout de permission","fail"),console.log(e)})}update(){this.permissionService.update(this.form.value,this.data.item.id).subscribe(e=>{r.a.updateFields(this.form.value,this.data.item),this.snackbarService.openSnackBar("Permission modifier avec succ\xe8s","success"),this.matDialogRef.close()},e=>{this.snackbarService.openSnackBar("Erreur lors de la modification de permission","fail")})}}return e.\u0275fac=function(t){return new(t||e)(o.Nb(a.b),o.Nb(a.d),o.Nb(a.a),o.Nb(l.a),o.Nb(b.a),o.Nb(d.b))},e.\u0275cmp=o.Hb({type:e,selectors:[["app-cb-permissions-modal"]],decls:18,vars:6,consts:[[1,"dialog-container"],["class","dialog-title",4,"ngIf"],[1,"row","justify-content-center","align-items-center","p-4","pt-3",3,"formGroup"],[1,"col-12"],["appearance","outline",1,"full-width"],["formControlName","name","matInput","","type","text"],[4,"ngIf"],[1,"col-12","mt-1"],["formControlName","description","matInput","","type","text"],["class","submit-btn full-width",3,"disabled","click",4,"ngIf"],[1,"dialog-title"],[1,"submit-btn","full-width",3,"disabled","click"]],template:function(e,t){1&e&&(o.Tb(0,"div",0),o.Gc(1,p,2,0,"p",1),o.Gc(2,f,2,0,"p",1),o.Tb(3,"form",2),o.Tb(4,"div",3),o.Tb(5,"mat-form-field",4),o.Tb(6,"mat-label"),o.Ic(7,"Nom"),o.Sb(),o.Ob(8,"input",5),o.Gc(9,h,2,1,"mat-error",6),o.Sb(),o.Sb(),o.Tb(10,"div",7),o.Tb(11,"mat-form-field",4),o.Tb(12,"mat-label"),o.Ic(13,"Description"),o.Sb(),o.Ob(14,"input",8),o.Sb(),o.Sb(),o.Tb(15,"div",3),o.Gc(16,S,2,1,"button",9),o.Gc(17,v,2,1,"button",9),o.Sb(),o.Sb(),o.Sb()),2&e&&(o.Bb(1),o.nc("ngIf",!t.data.isEditMode),o.Bb(1),o.nc("ngIf",t.data.isEditMode),o.Bb(1),o.nc("formGroup",t.form),o.Bb(6),o.nc("ngIf",!t.form.hasError("required")),o.Bb(7),o.nc("ngIf",!t.data.isEditMode),o.Bb(1),o.nc("ngIf",t.data.isEditMode))},directives:[s.k,n.v,n.o,n.h,m.c,m.f,n.c,u.b,n.n,n.f,m.b],styles:[""]}),e})();var T=i("M9IT"),w=i("zWtS"),I=i("oj2T"),k=i("5chL"),y=i("NFeN");function B(e,t){1&e&&(o.Tb(0,"mat-header-cell"),o.Ic(1,"Nom"),o.Sb())}function G(e,t){if(1&e&&(o.Tb(0,"mat-cell"),o.Tb(1,"p",20),o.Ic(2),o.Sb(),o.Sb()),2&e){const e=t.$implicit;o.Bb(2),o.Kc(" ",e.name," ")}}function C(e,t){1&e&&(o.Tb(0,"mat-header-cell"),o.Ic(1,"Description"),o.Sb())}function N(e,t){if(1&e&&(o.Tb(0,"mat-cell"),o.Tb(1,"p",20),o.Ic(2),o.Sb(),o.Sb()),2&e){const e=t.$implicit;o.Bb(2),o.Kc(" ",e.description," ")}}function D(e,t){1&e&&(o.Tb(0,"mat-header-cell"),o.Ic(1,"Actions"),o.Sb())}function M(e,t){if(1&e){const e=o.Ub();o.Tb(0,"mat-cell",20),o.Tb(1,"div",21),o.bc("click",(function(){o.xc(e);const i=t.$implicit;return o.fc(3).delete(i)})),o.Tb(2,"mat-icon"),o.Ic(3,"delete_forever"),o.Sb(),o.Sb(),o.Tb(4,"div",21),o.bc("click",(function(){o.xc(e);const i=t.$implicit;return o.fc(3).openModal(!0,i)})),o.Tb(5,"mat-icon"),o.Ic(6,"mode_edit"),o.Sb(),o.Sb(),o.Sb()}}function x(e,t){1&e&&o.Ob(0,"mat-header-row",22)}function R(e,t){1&e&&o.Ob(0,"mat-row",23)}const j=function(){return[10]};function E(e,t){if(1&e&&(o.Tb(0,"div",9),o.Tb(1,"table",10),o.Rb(2,11),o.Gc(3,B,2,0,"mat-header-cell",12),o.Gc(4,G,3,1,"mat-cell",13),o.Qb(),o.Rb(5,14),o.Gc(6,C,2,0,"mat-header-cell",12),o.Gc(7,N,3,1,"mat-cell",13),o.Qb(),o.Rb(8,15),o.Gc(9,D,2,0,"mat-header-cell",12),o.Gc(10,M,7,0,"mat-cell",16),o.Qb(),o.Gc(11,x,1,0,"mat-header-row",17),o.Gc(12,R,1,0,"mat-row",18),o.Sb(),o.Ob(13,"mat-paginator",19),o.Sb()),2&e){const e=o.fc(2);o.Bb(1),o.nc("dataSource",e.dataSource),o.Bb(10),o.nc("matHeaderRowDef",e.displayedColumns),o.Bb(1),o.nc("matRowDefColumns",e.displayedColumns),o.Bb(1),o.nc("pageSizeOptions",o.pc(5,j))("length",null==e.permissions?null:e.permissions.length)}}function O(e,t){if(1&e){const e=o.Ub();o.Tb(0,"div",1),o.Tb(1,"div",2),o.Tb(2,"div"),o.Tb(3,"p",3),o.Tb(4,"span",4),o.Ic(5,"lock"),o.Sb(),o.Ic(6," Liste des permissions "),o.Sb(),o.Sb(),o.Tb(7,"div"),o.Tb(8,"button",5),o.bc("click",(function(){return o.xc(e),o.fc().openModal(!1,null)})),o.Tb(9,"i",6),o.Ic(10," add "),o.Sb(),o.Sb(),o.Sb(),o.Sb(),o.Gc(11,E,14,6,"div",7),o.Ob(12,"app-cb-errors",8),o.Sb()}if(2&e){const e=o.fc();o.Bb(11),o.nc("ngIf",(null==e.permissions?null:e.permissions.length)>0),o.Bb(1),o.nc("array",e.permissions)("error",e.error)}}let A=(()=>{class e{constructor(e,t,i,s,n){this.spinnerService=e,this.dialog=t,this.alertService=i,this.permissionService=s,this.snackbarService=n,this.dataSource=new c.k,this.displayedColumns=["name","description","buttons"],this.permissions=[],this.error=!1,this.loading=!1}set paginator(e){e&&(this.dataSource.paginator=e)}ngOnInit(){this.loading=!0,this.spinnerService.activate(),this.permissionService.getAll().subscribe(e=>{this.loading=!1,this.permissions=e,this.dataSource.data=e,this.spinnerService.deactivate()},e=>{this.loading=!1,this.error=!0,this.spinnerService.deactivate()})}openModal(e,t){this.dialog.open(g,{panelClass:"custom-dialog-container",width:"600px",data:{item:t,array:this.permissions,isEditMode:e}}).afterClosed().subscribe(e=>{this.dataSource.data=this.permissions})}delete(e){this.alertService.showAlert(()=>{this.permissionService.delete(e.id).subscribe(t=>{this.snackbarService.openSnackBar("Permission supprim\xe9 avec succ\xe8s","success"),r.a.deleteFromArray(e,this.permissions),this.dataSource.data=this.permissions},e=>{this.snackbarService.openSnackBar("Erreur lors de la suppression","fail"),console.log(e)})},"voulez-vous vraiment supprimer ?")}}return e.\u0275fac=function(t){return new(t||e)(o.Nb(w.a),o.Nb(a.b),o.Nb(I.a),o.Nb(b.a),o.Nb(l.a))},e.\u0275cmp=o.Hb({type:e,selectors:[["app-cb-permissions"]],viewQuery:function(e,t){var i;1&e&&o.Lc(T.a,!0),2&e&&o.sc(i=o.cc())&&(t.paginator=i.first)},decls:1,vars:1,consts:[["class","page",4,"ngIf"],[1,"page"],[1,"row","mt-3","mb-3","justify-content-between","align-items-center"],[1,"title"],[1,"material-icons","title-icon"],[1,"square-btn","ml-2",3,"click"],[1,"material-icons","icon-blue"],["class","row",4,"ngIf"],[3,"array","error"],[1,"row"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","name"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","description"],["matColumnDef","buttons"],["class","cell-text",4,"matCellDef"],["class","text-center",4,"matHeaderRowDef"],["class","contact",4,"matRowDef","matRowDefColumns"],[1,"full-width",3,"pageSizeOptions","length"],[1,"cell-text"],[1,"cell-btn",3,"click"],[1,"text-center"],[1,"contact"]],template:function(e,t){1&e&&o.Gc(0,O,13,3,"div",0),2&e&&o.nc("ngIf",!t.loading)},directives:[s.k,k.a,c.j,c.c,c.e,c.b,c.g,c.i,T.a,c.d,c.a,y.a,c.f,c.h],styles:[""]}),e})();var q=i("tyNb"),P=i("PCNd"),Q=i("d3UM");const z=[{path:"",component:A}];let H=(()=>{class e{}return e.\u0275mod=o.Lb({type:e}),e.\u0275inj=o.Kb({factory:function(t){return new(t||e)},imports:[[s.c,q.e.forChild(z),P.a,T.b,c.l,y.b,a.c,n.s,m.e,Q.b,u.c]]}),e})()}}]);